Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 1a0343ed-4a62-440b-a494-d99885438302
KnownVulnerableSamples:
- Authentihash:
    MD5: d82a89cc750ae680af9f463b1b4ec8d9
    SHA1: 3b61791f361c785019347cff13712400198c9364
    SHA256: 1997e2a6302f3196975f858fef63188a249f79b6c2982d31ae07405e8aada58f
  Company: RW-Everything
  Copyright: Copyright (C) 2011 RW-Everything
  CreationTimestamp: '2013-05-01 21:59:34'
  Date: ''
  Description: RwDrv Driver
  ExportedFunctions: ''
  FileVersion: '1.00.00.0000 built by: WinDDK'
  Filename: ''
  ImportedFunctions:
  - IoDeleteSymbolicLink
  - ExFreePoolWithTag
  - IoRegisterPlugPlayNotification
  - MmFreeContiguousMemorySpecifyCache
  - RtlInitUnicodeString
  - IoDeleteDevice
  - IoFreeWorkItem
  - KeInitializeEvent
  - RtlQueryRegistryValues
  - KeReleaseSpinLock
  - MmUnmapIoSpace
  - IoFreeMdl
  - MmGetPhysicalAddress
  - IoGetDeviceObjectPointer
  - IoBuildAsynchronousFsdRequest
  - ExInterlockedInsertTailList
  - IoAllocateWorkItem
  - IoBuildDeviceIoControlRequest
  - IoUnregisterPlugPlayNotification
  - IofCompleteRequest
  - KeWaitForSingleObject
  - IoFreeIrp
  - RtlCompareMemory
  - MmUnlockPages
  - IoCreateSymbolicLink
  - RtlCopyUnicodeString
  - ObfDereferenceObject
  - IoCreateDevice
  - IoQueueWorkItem
  - RtlAssert
  - MmAllocateContiguousMemorySpecifyCache
  - DbgPrint
  - IofCallDriver
  - KeAcquireSpinLockRaiseToDpc
  - KeBugCheckEx
  - MmMapIoSpace
  - ExAllocatePoolWithTag
  - KeStallExecutionProcessor
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  InternalName: RwDrv.sys
  MD5: 9650db2ef0a44984845841ab24972ced
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: RwDrv.sys
  PDBPath: ''
  Product: RwDrv Driver
  ProductVersion: 1.00.00.0000
  Publisher: ''
  RichPEHeaderHash:
    MD5: 34f9ee05d0625423a967fe59af07b3b7
    SHA1: 977c80038c9a4ea1b19a46fbaf339efa52332028
    SHA256: 7ab534cf1988576feaa977b3906d1f22777b8a1bbb0b27345834b4d37d1fabb8
  SHA1: 9d191bee98f0af4969a26113098e3ea85483ae2d
  SHA256: bdcacb9f373b017d0905845292bca2089feb0900ce80e78df1bcaae8328ce042
  Sections:
    .data:
      Entropy: 0.46979092711892695
      Virtual Size: '0x130'
    .pdata:
      Entropy: 3.8809705707794
      Virtual Size: '0x1d4'
    .rdata:
      Entropy: 4.069864946156118
      Virtual Size: '0x2bc'
    .rsrc:
      Entropy: 3.271210025777123
      Virtual Size: '0x370'
    .text:
      Entropy: 5.5452107521100436
      Virtual Size: '0x3948'
    INIT:
      Entropy: 5.490832644719796
      Virtual Size: '0x790'
  Signature: ''
  Signatures:
  - Certificates:
    - IsCertificateAuthority: true
      SerialNumber: 7e93ebfb7cc64e59ea4b9a77d406fc3b
      Signature: 03099b8f79ef7f5930aaef68b5fae3091dbb4f82065d375fa6529f168dea1c9209446ef56deb587c30e8f9698d23730b126f47a9ae3911f82ab19bb01ac38eeb599600adce0c4db2d031a6085c2a7afce27a1d574ca86518e979406225966ec7c7376a8321088e41eaddd9573f1d7749872a16065ea6386a2212a35119837eb6
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=US, O=Symantec Corporation, CN=Symantec Time Stamping Services CA
        , G2
      TBS:
        MD5: d0785ad36e427c92b19f6826ab1e8020
        SHA1: 365b7a9c21bd9373e49052c3e7b3e4646ddd4d43
        SHA256: c2abb7484da91a658548de089d52436175fdb760a1387d225611dc0613a1e2ff
      ValidFrom: '2012-12-21 00:00:00'
      ValidTo: '2020-12-30 23:59:59'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 0400000000012f4ee1355c
      Signature: 225cc5dd3df40b70d8e3f5e7c58e0901bbb196365c5a07adc7a8444951257aae0da4193b929ccfb94226bb3b6c97e7c7ce116d6891da8d6df1534d54388c61f3c8827669be81320b31c36cc99e200a582ff048fe7e4807aad743589473540431a9780d3b8cb070c13d7ed7bd2f2ac3e2f58f0c90dc6ba5c8be685e5d6df878d2be49951e15780891fb34c8be84adbce0c6dd18dbf3caf07bc2143c18b803ba953e211e3f60697a7f6a039e8d4af9f0282c30845eec267242b16dcb64c3128cd6844b67417cb103177809e3ada8b6962da47e80034f88f7c16b5a4615cd2c198bd8709ce52d49886072a8a4195270435edad64603b0680e24ef4af60b2524ef24
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=BE, O=GlobalSign nv,sa, CN=GlobalSign CodeSigning CA , G2
      TBS:
        MD5: f6a9e8eb8784f3f694b4e353c08a0ff5
        SHA1: 589a7d4df869395601ba7538a65afae8c4616385
        SHA256: cbdc9a0ad785d0c2013211746b42234e18bdc7d54a7a260647badc1c9e712ed4
      ValidFrom: '2011-04-13 10:00:00'
      ValidTo: '2019-04-13 10:00:00'
      Version: 3
    - IsCertificateAuthority: false
      SerialNumber: 11218f56dafd7542d5f3d70b213e2a546cff
      Signature: 6b86336c2008e3d1a9cb42f4e323c36c782602b06948e63b7cc646ca61b5768677c2cdd5cf24f58d68844079cd6d8e9534b3170a0261fe64ea47971eecf4a84de8174a4a8b5c6ad87894cf5cc8a10ec522db9697504b208442ae34ec6e9a0e85d93470f66374f36c4f1ec3483c136497b2880d8ba4de0342b5aa2c0890ad80e010c8e34ae8792740e677952d3bc05a36a032ab7bbb64051d506f674e0232f66900c8c29dad2df6960012a8bb216f9e83157632545ead40db592c1e7de76f407601b111113e9b087db3e780f21a61e9f7593e96332f0c35162e0900a61c6ba3a88faee64d9fe94cad5705d6d16585603b5bb376161bdcf01b0bb9022bb360aceb
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=TW, CN=ChongKim Chan
      TBS:
        MD5: b990c61c8edf9e8d0ac6504541be0b65
        SHA1: 519e011f6cab88c812da20225dd37cc1808d5180
        SHA256: 5b8b9e8e3ddd3ab7cc1f8531e88d83cb075539bb4473ed348d80a13dc1a4e065
      ValidFrom: '2012-07-31 20:41:59'
      ValidTo: '2013-08-01 20:41:59'
      Version: 3
    - IsCertificateAuthority: false
      SerialNumber: 0ecff438c8febf356e04d86a981b1a50
      Signature: 783bb4912a004cf08f62303778a38427076f18b2de25dca0d49403aa864e259f9a40031cddcee379cb216806dab632b46dbff42c266333e449646d0de6c3670ef705a4356c7c8916c6e9b2dfb2e9dd20c6710fcd9574dcb65cdebd371f4378e678b5cd280420a3aaf14bc48829910e80d111fcdd5c766e4f5e0e4546416e0db0ea389ab13ada097110fc1c79b4807bac69f4fd9cb60c162bf17f5b093d9b5be216ca13816d002e380da8298f2ce1b2f45aa901af159c2c2f491bdb22bbc3fe789451c386b182885df03db451a179332b2e7bb9dc20091371eb6a195bcfe8a530572c89493fb9cf7fc9bf3e226863539abd6974acc51d3c7f92e0c3bc1cd80475
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=US, O=Symantec Corporation, CN=Symantec Time Stamping Services Signer
        , G4
      TBS:
        MD5: e9d38360b914c8863f6cba3ee58764d3
        SHA1: 4cba8eae47b6bf76f20b3504b98b8f062694a89b
        SHA256: 88901d86a4cc1f1bb193d08e1fb63d27452e63f83e228c657ab1a92e4ade3976
      ValidFrom: '2012-10-18 00:00:00'
      ValidTo: '2020-12-29 23:59:59'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 6129152700000000002a
      Signature: 5ff8d065746a81c6a6ca5b03b6914ae84bbdef2ba142f0efb4a5adcd3389ec0b9585ac62501108aa58d25aa08310e5a6337af25af2c5fe787cf09c83df190ad97396002dd62ccde914d41d9de83f3c1a76f7904efb01350a6c9313a0c356eb67a0e4d17a96dec267f190f80a7bf5321b94ec5f751f8d1b34da6c58a7cb2d279e2226b7c9aa30cc0777b836e38201b5393ccc8dd9a75f7f23b3877fdb5798918bd7ce2520e39d644fdd87f72b68490318e0a5df7c5f68644d36838d4781f2e9e0a869abfa7b163c05a449ea8830190a6c73055178dfd41ddd3ad47f2de44e54be83431e7a7433b4a4ebd77073bc2a02988966eef6bc8f749378e329025a5a43e258ce7ccf9acad236893be25fda26054ec8d4e72c910e1797c5beee8b13112323294ffa83d050f6bafad53db3173df4ff034aa325dce67561d1fa35086bd62744d068b78d45e0eb852cc8a15d614474160e5958aed2b5eea5bcd6d7076ab62978fd976767dd8d4f17944fd2ed0caf972437c3a29c81da6be143b6577b4cecbf791319e79fe844e94781b75e701e91f83dd17b27f50b7056434805dda92fab86101d0b12e31ad04c6e75ded645b30b748887935c564a41029af7aeb799d8b67f88fa11f2457cf4d71b91c01cf1a0fbd4080a411a142acef4eb34486e66879ed54b7a397fbb0e3d3861cf735706e412066bd96b5308cd7018c22d4f974691bca9f0
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=BE, O=GlobalSign nv,sa, OU=Root CA, CN=GlobalSign Root CA
      TBS:
        MD5: 0bb058d116f02817737920f112d9fd3b
        SHA1: fd116235171a4feafedee586b7a59185fb5fd7e6
        SHA256: f970426cc46d2ae0fc5f899fa19dbe76e05f07e525654c60c3c9399492c291f4
      ValidFrom: '2011-04-15 19:55:08'
      ValidTo: '2021-04-15 20:05:08'
      Version: 3
    CertificatesInfo: ''
    Signer:
    - Issuer: C=BE, O=GlobalSign nv,sa, CN=GlobalSign CodeSigning CA , G2
      SerialNumber: 11218f56dafd7542d5f3d70b213e2a546cff
      Version: 1
    SignerInfo: ''
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- RwDrv.sys
Verified: 'TRUE'
