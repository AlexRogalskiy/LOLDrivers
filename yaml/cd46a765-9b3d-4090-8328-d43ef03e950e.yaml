Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: cd46a765-9b3d-4090-8328-d43ef03e950e
KnownVulnerableSamples:
- Authentihash:
    MD5: c544f0e3309f602e2caad1193289ae3e
    SHA1: 74cbc407acd9d2a4bc609b2f8c9a09b90912d10c
    SHA256: f05a1df10900b05fb7211f3dadd15003fc91cfa28a08bcc6d7afa02cd8ab3d5c
  Company: ''
  Copyright: ''
  CreationTimestamp: '2021-03-15 20:41:39'
  Date: ''
  Description: ''
  ExportedFunctions: ''
  FileVersion: ''
  Filename: ''
  ImportedFunctions:
  - FwpmFilterAdd0
  - FwpmFilterDeleteById0
  - FwpsAcquireClassifyHandle0
  - FwpmCalloutAdd0
  - FwpsCompleteClassify0
  - FwpsAcquireWritableLayerDataPointer0
  - FwpsApplyModifiedLayerData0
  - FwpmSubLayerDeleteByKey0
  - FwpmSubLayerAdd0
  - FwpmTransactionAbort0
  - FwpmTransactionCommit0
  - FwpmTransactionBegin0
  - FwpmEngineClose0
  - FwpmEngineOpen0
  - FwpsCalloutUnregisterById0
  - FwpsReleaseClassifyHandle0
  - FwpsCalloutRegister1
  - KeInitializeEvent
  - KeWaitForSingleObject
  - IoAllocateIrp
  - IofCallDriver
  - IoCreateFile
  - IoFreeIrp
  - IoGetRelatedDeviceObject
  - ObReferenceObjectByHandle
  - ObfDereferenceObject
  - ZwQueryInformationFile
  - ZwSetInformationFile
  - ZwReadFile
  - ZwWriteFile
  - ZwClose
  - IoFileObjectType
  - strchr
  - strncat
  - strncpy_s
  - strstr
  - KeResetEvent
  - MmProbeAndLockPages
  - MmUnlockPages
  - IoAllocateMdl
  - IoFreeMdl
  - IoReuseIrp
  - __C_specific_handler
  - DbgPrintEx
  - vDbgPrintEx
  - vDbgPrintExWithPrefix
  - MmIsAddressValid
  - ExSystemTimeToLocalTime
  - sprintf
  - _vsnwprintf
  - KeEnterCriticalRegion
  - KeLeaveCriticalRegion
  - PsTerminateSystemThread
  - KeSetBasePriorityThread
  - CmUnRegisterCallback
  - CmRegisterCallbackEx
  - CmCallbackGetKeyObjectID
  - strncmp
  - strncpy
  - wcsncmp
  - ExAcquireSpinLockExclusive
  - ExReleaseSpinLockExclusive
  - RtlCreateSecurityDescriptor
  - RtlSetDaclSecurityDescriptor
  - KeInitializeTimerEx
  - KeSetTimerEx
  - PsCreateSystemThread
  - ZwCreateKey
  - ZwOpenKey
  - ZwFlushKey
  - ZwQueryValueKey
  - ZwSetValueKey
  - NtQueryInformationToken
  - RtlLengthSid
  - RtlConvertSidToUnicodeString
  - RtlCreateAcl
  - RtlAddAccessAllowedAce
  - RtlSetOwnerSecurityDescriptor
  - PsLookupProcessByProcessId
  - ObOpenObjectByPointer
  - ZwOpenProcessTokenEx
  - ZwSetSecurityObject
  - PsGetProcessImageFileName
  - PsProcessType
  - SeExports
  - IoDeleteSymbolicLink
  - ExFreePoolWithTag
  - ExAllocatePoolWithTag
  - KeSetEvent
  - RtlFreeUnicodeString
  - KeBugCheckEx
  - RtlCopyUnicodeString
  - RtlAnsiStringToUnicodeString
  - RtlInitUnicodeString
  - RtlInitAnsiString
  - RtlTimeToTimeFields
  - WskCaptureProviderNPI
  - WskReleaseProviderNPI
  - WskDeregister
  - WskRegister
  - WdfVersionBind
  - WdfVersionBindClass
  - WdfVersionUnbindClass
  - WdfVersionUnbind
  Imports:
  - fwpkclnt.sys
  - ntoskrnl.exe
  - NETIO.SYS
  - WDFLDR.SYS
  InternalName: ''
  MD5: c664fc54853d9b50d7e33bad5bd7070e
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: ''
  PDBPath: ''
  Product: ''
  ProductVersion: ''
  Publisher: ''
  RichPEHeaderHash:
    MD5: a47d93f02dee54ad56542d814d001142
    SHA1: 2d6f2588a47d00c1c29caf3788c526b269336c9f
    SHA256: bbb6ea1f1094dc888e550580580a36bd7037614d3cd2e82f9ebbe8603b2ef205
  SHA1: 3a49efb4cf120b01479c4dd705d8de403e184488
  SHA256: 5d0d5373c5e52c4405f4bd963413e6ef3490b7c4c919ec2d4e3fb92e91f397a0
  Sections:
    .data:
      Entropy: 1.3922294956110923
      Virtual Size: '0x9468'
    .pdata:
      Entropy: 4.41984769721976
      Virtual Size: '0x600'
    .rdata:
      Entropy: 4.6810410390267405
      Virtual Size: '0x1204'
    .reloc:
      Entropy: 3.7366309574076895
      Virtual Size: '0x3c'
    .text:
      Entropy: 6.352901452506092
      Virtual Size: '0x69c8'
    INIT:
      Entropy: 5.275916510674749
      Virtual Size: '0xcdc'
  Signature: ''
  Signatures:
  - Certificates:
    - IsCertificateAuthority: false
      SerialNumber: 33000000b5213fca1e4aa03de40000000000b5
      Signature: 0d2d53cd15a8feddcb17e2df1bf7dc1aef21e98c6cd220f58b593824849c134a0f1add59ce42ef80ddf47860273013604d9568ec5894a797bd4e571432a9aaf10ab04dd1c038b26ab7c5ca3a9c88d009267fab56254525546a0a055fb37b9cd8029c7d501809fc8b11482c7a4347b3ad29f35427c9570e87117db52cc94864259274b9e2e758f918a3af1fdb9f9d40ffa3ae2e2ae012fb97a436258642a2a4223dc6690db88103a6e5220646bd8afb3d12eb894ac28b527396a1965408487f6ab878b3c474b8c960842861ae8e799a3d2a8d6f918f50f8e26bb1ed6ced47be36e447574e8568582964ff31cd288b9c7f8d7e6a46d6c3d92f5c101fe1522a720c
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Hardware Compatibility Publisher
      TBS:
        MD5: a0dd89c33c4973bf6758331e200fb6de
        SHA1: 65ff7fa429c0f08f8a8bf30509e8ca2919d9edb5
        SHA256: 29a7b646af062aee3bf37d1ba190211365116db7d7aa4cb87ba268843262ae47
      ValidFrom: '2020-12-15 22:15:33'
      ValidTo: '2021-12-02 22:15:33'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 610baac1000000000009
      Signature: 5a8a67daccd5fd0d264177bf0a4678b4b3de12692b7723c2652f015fd203f461ba509d2e8c3972f36c3e6ab11e766decb7f382dcccbbc56970287366173f54ebee011648c446d91b80ae813a8d0f796d68b09eea2d3f39d3ca387ebd5e7c086e19dcc6c2f438336861e2524783e1000156d2bacb878205310a418b4ee77f5f5fed5fd3392d45eba213bffd1ec298417161165fc80a70257c59693124e471e70abb0417f79f721ec9d2bb1abe3d02fe090cb243b4591a99539396215fe0d6b72601429536ac27fdbef48577683d18bdf4be98882211865216f345ec0397107087a37043713cdbc98603170cf5735bc67de15c64edd7c548d7ed32e2d1aad3cfa7f6574e61f977eb67f288b3de00da038fd08a34373e1dd862b8d2b1f3e12f8b723b81967c6ffcec667672601b24f2a0896d5b6d002eef28dd868705c2b4b9e5be64c22af24a155c98e2c42785ff52e3627e0fb2020bd766c70ab2d33d200414503259830a7d9bed5a38120152ba2f5e20728e4af1fde771028c3be107bec973f4dd47d8b4efb4a4b330b9893e76cab90098567eabea8ab8a5d038ab6977130b142fe9aa411ff7babd3a2b348aee0aab63e663f788248e200d2b3b9de3c24952ac9f1f0e393b5dd46e506ae67d523aaa7c3315290d265e0158a74ea93d7a846f743f609fe4324f3600af6d71d33ea646655f8174f1fec171da4ca0415a82ddf11f
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Third Party Component CA 2012
      TBS:
        MD5: a569061297e8e824767dbc3184a69bea
        SHA1: adbb26a587a8f44b4fccaecb306f980d1c55a150
        SHA256: cec1afd0e310c55c1dcc601ab8e172917706aa32fb5eaf826813547fdf02dd46
      ValidFrom: '2012-04-18 23:48:38'
      ValidTo: '2027-04-18 23:58:38'
      Version: 3
    CertificatesInfo: ''
    Signer:
    - Issuer: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Third Party Component CA 2012
      SerialNumber: 33000000b5213fca1e4aa03de40000000000b5
      Version: 1
    SignerInfo: ''
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- ''
Verified: 'TRUE'
