Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 7bf75164-11fc-4960-b8d0-0caa3507857e
KnownVulnerableSamples:
- Authentihash:
    MD5: 2abd5f1a10f8e86388b934a11d9c1eda
    SHA1: 1923d1f21faffcd7d511e2b313fe9415e6ad90ae
    SHA256: c174566743b47ae3c3bbb9f32d2856de5959e06ec100b648853058eefcda43fa
  Company: ''
  Copyright: ''
  CreationTimestamp: '2021-03-15 20:41:07'
  Date: ''
  Description: ''
  ExportedFunctions: ''
  FileVersion: ''
  Filename: ''
  ImportedFunctions:
  - FwpsAcquireClassifyHandle0
  - FwpsReleaseClassifyHandle0
  - FwpmFilterDeleteById0
  - FwpsAcquireWritableLayerDataPointer0
  - FwpsApplyModifiedLayerData0
  - FwpmFilterAdd0
  - FwpmCalloutAdd0
  - FwpmSubLayerDeleteByKey0
  - FwpmSubLayerAdd0
  - FwpmTransactionAbort0
  - FwpmTransactionCommit0
  - FwpmTransactionBegin0
  - FwpmEngineClose0
  - FwpmEngineOpen0
  - FwpsCalloutUnregisterById0
  - FwpsCompleteClassify0
  - FwpsCalloutRegister1
  - KeGetCurrentThread
  - KeInitializeEvent
  - KeWaitForSingleObject
  - IoAllocateIrp
  - IofCallDriver
  - IoCreateFile
  - IoFreeIrp
  - IoGetRelatedDeviceObject
  - ObReferenceObjectByHandle
  - ObfDereferenceObject
  - ZwQueryInformationFile
  - ZwSetInformationFile
  - ZwReadFile
  - ZwWriteFile
  - ZwClose
  - IoFileObjectType
  - strchr
  - strncat
  - strncpy_s
  - strstr
  - KeResetEvent
  - MmProbeAndLockPages
  - MmUnlockPages
  - IoAllocateMdl
  - IoFreeMdl
  - IoReuseIrp
  - DbgPrintEx
  - vDbgPrintEx
  - vDbgPrintExWithPrefix
  - RtlTimeToTimeFields
  - KeQuerySystemTime
  - IoDeleteSymbolicLink
  - sprintf
  - _vsnwprintf
  - KeEnterCriticalRegion
  - KeLeaveCriticalRegion
  - PsTerminateSystemThread
  - KeSetBasePriorityThread
  - CmUnRegisterCallback
  - CmRegisterCallbackEx
  - CmCallbackGetKeyObjectID
  - strncmp
  - strncpy
  - wcsncmp
  - ExAcquireSpinLockExclusive
  - ExReleaseSpinLockExclusive
  - RtlCreateSecurityDescriptor
  - RtlSetDaclSecurityDescriptor
  - KeInitializeTimerEx
  - KeSetTimerEx
  - PsCreateSystemThread
  - ZwCreateKey
  - ZwOpenKey
  - ZwFlushKey
  - ZwQueryValueKey
  - ZwSetValueKey
  - NtQueryInformationToken
  - RtlLengthSid
  - RtlConvertSidToUnicodeString
  - RtlCreateAcl
  - RtlAddAccessAllowedAce
  - RtlSetOwnerSecurityDescriptor
  - PsLookupProcessByProcessId
  - ObOpenObjectByPointer
  - ZwOpenProcessTokenEx
  - ZwSetSecurityObject
  - PsGetProcessImageFileName
  - _allmul
  - PsProcessType
  - SeExports
  - memcpy
  - RtlUnwind
  - memset
  - MmIsAddressValid
  - ExFreePoolWithTag
  - ExAllocatePoolWithTag
  - KeSetEvent
  - KeBugCheckEx
  - RtlFreeUnicodeString
  - RtlCopyUnicodeString
  - RtlAnsiStringToUnicodeString
  - RtlInitUnicodeString
  - RtlInitAnsiString
  - ExSystemTimeToLocalTime
  - WskDeregister
  - WskReleaseProviderNPI
  - WskCaptureProviderNPI
  - WskRegister
  - KeGetCurrentIrql
  - WdfVersionBind
  - WdfVersionBindClass
  - WdfVersionUnbindClass
  - WdfVersionUnbind
  Imports:
  - fwpkclnt.sys
  - ntoskrnl.exe
  - NETIO.SYS
  - HAL.dll
  - WDFLDR.SYS
  InternalName: ''
  MD5: ccea678c13f13a8d6438a314e26cdc2a
  MachineType: I386
  MagicHeader: 50 45 0 0
  OriginalFilename: ''
  PDBPath: ''
  Product: ''
  ProductVersion: ''
  Publisher: ''
  RichPEHeaderHash:
    MD5: 3b4691d934a09c9e9405216d4916ad8a
    SHA1: beadde6d5d5b7e6a188598980e4ce7540b8e90ca
    SHA256: 186f36b59d5535ba21343e53d01b70400138d19e0eebdb55a755ecd612ad08b7
  SHA1: 3b34f042bfc12062529595706493086fffe9d61b
  SHA256: 4ce61ad21f186cf10dbcc253feee31262203cb5c12c5a140d2dda5447c57aba1
  Sections:
    .data:
      Entropy: 1.1710911980649088
      Virtual Size: '0x6d28'
    .rdata:
      Entropy: 4.515485502934939
      Virtual Size: '0x8fc'
    .reloc:
      Entropy: 6.621340981410155
      Virtual Size: '0x5d4'
    .text:
      Entropy: 6.609621758675047
      Virtual Size: '0x5712'
    INIT:
      Entropy: 5.568864251423928
      Virtual Size: '0xb88'
  Signature: ''
  Signatures:
  - Certificates:
    - IsCertificateAuthority: true
      SerialNumber: 7327097da23417a74d45181fb160f9f7
      Signature: 9d9c50d62f1d3f83e5674790b79a01dd9657691bc22921c135ef920701916ee70111da99bdcf8e14e724f5ae67453cdded4fd3bb59e8e30c3eccf8848c9070f943a7400380739723113d7d2f52dc02a67af40098362df9df6e5bc180b861ccaa600dd7793b98ab2cd1fff98823ecb5b29246443d512b2a2e348ad61e21606b8ba4925de502a70223b7018310947656bea89582d9c6ac9ae3a90482168fd4ba15436d4a0a7e02d671f37e7e20b9277a9529e5263a753838f90939fb27aa5346cc90eae02ba041df0243b42372da0464543b1b9218bfa53286e7c6b1d25656924d1e33a5bbb18a9bcfdc890ced58058fc928610ff44563389120721acd84745d96
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: CN=WDKTestCert omen,132578539763945900
      TBS:
        MD5: 5d145463479eab33d0b1ac71466b0053
        SHA1: 9b5f08d89d15ab86917e5f219f39c795ba31bb9a
        SHA256: dd6fc2174d74188dd80ab58623416d2c2c39716760e09a75e7fddf94aeb71e09
      ValidFrom: '2021-02-15 09:12:56'
      ValidTo: '2031-02-15 00:00:00'
      Version: 3
    CertificatesInfo: ''
    Signer:
    - Issuer: CN=WDKTestCert omen,132578539763945900
      SerialNumber: 7327097da23417a74d45181fb160f9f7
      Version: 1
    SignerInfo: ''
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- ''
Verified: 'TRUE'
