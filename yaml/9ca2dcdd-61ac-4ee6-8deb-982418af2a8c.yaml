Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 9ca2dcdd-61ac-4ee6-8deb-982418af2a8c
KnownVulnerableSamples:
- Authentihash:
    MD5: 26cbbcf09fcbba64d93342c273c480d2
    SHA1: 7aa2c4c51afc1c82beae55ab9ca7ba0bb588b5c0
    SHA256: df4e25990742fc8d3aed70f6cb4d402e111e7ed08fa5f76aca685b8c03b98b93
  Company: Windows (R) Win 7 DDK provider
  Copyright: Copyright  2020 nn.com
  CreationTimestamp: '2020-05-12 20:43:44'
  Date: ''
  Description: Leigod net data catcher.
  ExportedFunctions: ''
  FileVersion: 1.0.0.0
  Filename: ''
  ImportedFunctions:
  - FwpmFreeMemory0
  - FwpmEngineOpen0
  - FwpmEngineClose0
  - FwpmTransactionBegin0
  - FwpmTransactionCommit0
  - FwpmTransactionAbort0
  - FwpmProviderAdd0
  - FwpmProviderContextDeleteByKey0
  - FwpmSubLayerAdd0
  - FwpmSubLayerDeleteByKey0
  - FwpmSubLayerCreateEnumHandle0
  - FwpmSubLayerEnum0
  - FwpmSubLayerDestroyEnumHandle0
  - FwpmCalloutAdd0
  - FwpmFilterAdd0
  - FwpsFlowAbort0
  - FwpsInjectionHandleCreate0
  - FwpsQueryPacketInjectionState0
  - FwpsAllocateNetBufferAndNetBufferList0
  - FwpsFreeNetBufferList0
  - FwpsFreeCloneNetBufferList0
  - FwpsInjectNetworkSendAsync0
  - FwpsConstructIpHeaderForTransportPacket0
  - FwpsInjectTransportSendAsync0
  - FwpsInjectTransportReceiveAsync0
  - FwpsInjectNetworkReceiveAsync0
  - FwpsStreamInjectAsync0
  - FwpsCopyStreamDataToBuffer0
  - FwpmBfeStateGet0
  - FwpmBfeStateSubscribeChanges0
  - FwpmBfeStateUnsubscribeChanges0
  - FwpsFlowRemoveContext0
  - FwpsCompleteClassify0
  - FwpsRedirectHandleDestroy0
  - FwpsCloneStreamData0
  - FwpsDiscardClonedStreamData0
  - FwpsRedirectHandleCreate0
  - FwpsApplyModifiedLayerData0
  - FwpsAcquireWritableLayerDataPointer0
  - FwpsReleaseClassifyHandle0
  - FwpsAcquireClassifyHandle0
  - FwpsFlowAssociateContext0
  - FwpsCalloutUnregisterByKey0
  - FwpsCalloutRegister1
  - FwpsInjectionHandleDestroy0
  - FwpsPendClassify0
  - NdisFreeNetBufferListPool
  - NdisWaitEvent
  - NdisInitializeEvent
  - NdisFreeGenericObject
  - NdisAllocateGenericObject
  - NdisGetDataBuffer
  - NdisAdvanceNetBufferDataStart
  - NdisRetreatNetBufferDataStart
  - NdisAllocateNetBufferListPool
  - KeAcquireInStackQueuedSpinLock
  - KeReleaseInStackQueuedSpinLock
  - ExAllocatePoolWithTag
  - ExUuidCreate
  - swprintf_s
  - RtlInitUnicodeString
  - MmGetSystemRoutineAddress
  - RtlAppendUnicodeToString
  - RtlCreateSecurityDescriptor
  - RtlSetDaclSecurityDescriptor
  - KeInitializeEvent
  - KeSetEvent
  - KeWaitForSingleObject
  - KeInitializeSpinLock
  - ExFreePoolWithTag
  - ExQueryDepthSList
  - ExpInterlockedPopEntrySList
  - ExpInterlockedPushEntrySList
  - ExInitializeNPagedLookasideList
  - ExDeleteNPagedLookasideList
  - MmBuildMdlForNonPagedPool
  - MmMapLockedPagesSpecifyCache
  - MmUnmapLockedPages
  - MmAllocatePagesForMdl
  - MmFreePagesFromMdl
  - PsCreateSystemThread
  - PsTerminateSystemThread
  - IoAllocateMdl
  - IofCompleteRequest
  - IoCreateDevice
  - IoCreateSymbolicLink
  - IoDeleteDevice
  - IoDeleteSymbolicLink
  - IoFreeMdl
  - IoReleaseCancelSpinLock
  - ObReferenceObjectByHandle
  - ObfDereferenceObject
  - ZwClose
  - ZwOpenKey
  - ZwQueryValueKey
  - PsGetCurrentProcessId
  - ZwSetInformationThread
  - RtlLengthSid
  - RtlCreateAcl
  - RtlAddAccessAllowedAce
  - PsLookupProcessByProcessId
  - ObOpenObjectByPointer
  - ZwSetSecurityObject
  - __C_specific_handler
  - SeExports
  - RtlGetVersion
  - RtlCompareMemory
  - RtlValidSid
  Imports:
  - fwpkclnt.sys
  - NDIS.SYS
  - ntoskrnl.exe
  InternalName: LgDataCatcher.sys
  MD5: 3f87df040c35ea45dfd4ae371b9641ae
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: LgDataCatcher.sys
  PDBPath: ''
  Product: GameAcc
  ProductVersion: 1.0.0.0
  Publisher: ''
  RichPEHeaderHash:
    MD5: f40ea159736b62f8895bbfc28c0dfa09
    SHA1: 2be491e3b182f5df0605c27ed0d26fb08c6b4cf6
    SHA256: c5bd76e06c3bde6fd6494e77255dcfc2c35d59c7ebbf84df420b83198dbc16e1
  SHA1: 3864dfc19c8479a491bc3b0637cf0e789a6d53d8
  SHA256: 516159871730b18c2bddedb1a9da110577112d4835606ee79bb80e7a58784a13
  Sections:
    .data:
      Entropy: 2.0214134184014134
      Virtual Size: '0x1680'
    .pdata:
      Entropy: 4.952698187604174
      Virtual Size: '0xc24'
    .rdata:
      Entropy: 5.19122124724292
      Virtual Size: '0x1a04'
    .reloc:
      Entropy: 4.8522168041142235
      Virtual Size: '0x144'
    .rsrc:
      Entropy: 3.499847177522211
      Virtual Size: '0x3f8'
    .text:
      Entropy: 6.194279179648036
      Virtual Size: '0xfb3a'
    INIT:
      Entropy: 5.174414715416575
      Virtual Size: '0xef2'
  Signature: ''
  Signatures:
  - Certificates:
    - IsCertificateAuthority: true
      SerialNumber: 0400000000012f4ee152d7
      Signature: 4e5e56901e46b4d94931f3bb1739281bc216ddfd41dc0905049b6fb2a29ad6992e40990055b5ea3fa52076d38634d417cc553ac782eeefa8babcd8069f1550dfcd167b523a02d7191afdaff0785ce04bc518df3a241edaacb8a95804020730dbb0125efe31bef00448f4f070f83a5e5683cf3dfb0dbcf4c5ed979db9d4dba52784e3389b8ba735864420a43b6da46a0ba183fd28ebdaef28f6cc885dfb0a3b00abe021ebe22f356c0f8e344597eba2f79933357ecb9a8abb454de73f9fc2d98afa65b26ec77e65ffe892e12c31a2f7b02736488f266f3bee4d761f79c3e57f9635bc2d0ecc01b08e7fff518080a792d4b34446648c874f166307314b63b0dff3
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=BE, O=GlobalSign nv,sa, CN=GlobalSign Timestamping CA , G2
      TBS:
        MD5: e140543fe3256027cfa79fc3c19c1776
        SHA1: c655f94eb1ecc93de319fc0c9a2dc6c5ec063728
        SHA256: 3ca71e85908ff67368e4dc00253f5691b9e6d50c966e7784143d75fb92aa3448
      ValidFrom: '2011-04-13 10:00:00'
      ValidTo: '2028-01-28 12:00:00'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 04000000000125071df9af
      Signature: 4252a97ea2cf5b3bcb4bddbaf85759d324a47772ef62443782ed06ee04d5165f24a314dc6c54056ab09b3dda8139daad28db956f8183f5cd62b14524b1dd29e5085495958cf01d065f1ad6463f1340174811169b474dd13ab50f571c9230d0f8b2253b0acdf687f9c7b257d33f7da58c14ce9ca8c79f4693da59fa795d652035445a4fc1909dc1549256dc34c8f5c103d05dc059489c00fc95a0f1d176f71636c813927f2d2bc0b880f126261f414d52bf1e97bb018208e715f6c1d5342accf5e4c3877a5781e1d6d74286620177e2a9c47a86f404387a076a7d00ec73f7a80b3478c59eb3efb838400e8c3353c875ec5f3eea755eff820e7415dc1905f3ba31
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: OU=GlobalSign Root CA , R3, O=GlobalSign, CN=GlobalSign
      TBS:
        MD5: f47739306d14722e670d9436eadb8e4f
        SHA1: 457d9df00a652cb4c3356d00145d9528fc309172
        SHA256: bd1765c56594221373893ef26d97f88c144fb0e5a0111215b45d7239c3444df7
      ValidFrom: '2009-11-18 10:00:00'
      ValidTo: '2019-03-18 10:00:00'
      Version: 3
    - IsCertificateAuthority: false
      SerialNumber: 1121d699a764973ef1f8427ee919cc534114
      Signature: 8fa91a916d04a637200e8396de23d36b6e1f6edd643d682122b5f84736698ee1a545c724a222b72909cc545aaec6bccd638eb33d5048e5b4ccaecd928d9e288b134a11aabda3efd3b236fcb4a172bf6d9763798c44bc702f7ef3bcdd8253ab1af6ebfa1c97bcb6379ca41c30bcabbc2d4736df922003e871c658f675059a34f00b595a824434aa80e42f84f6475d96c9b6caca9db7a6bae450d3d437b8ba200ed0d3922a5bc459bba16ddb3cce449dc1382aade38dbdcd09771a10be670a02366488b9b31b26eee79e60c446a8bc61336ccf4eb99cb96af09f37feb53d4f9ad34dffde208e4e97a6fd9f09bc4dca1876c9b04d8550f280d21d06f5580407b118
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=SG, O=GMO GlobalSign Pte Ltd, CN=GlobalSign TSA for MS Authenticode
        , G2
      TBS:
        MD5: acb5170547d76873f1e4ff18ed5de2eb
        SHA1: bd6e261e75b807381bada7287de04d259258a5fa
        SHA256: 4783380498acf592286ef2dea0fcc5bdea3f54d5e374d3e3497df9d5f662cfb6
      ValidFrom: '2016-05-24 00:00:00'
      ValidTo: '2027-06-24 00:00:00'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 481b6a07a9424c1eaafef3cdf10f
      Signature: 7609c4cc2fd9ef1e4ba9f857f3403921ca4c3c1d9e292b20d42b44d288ce1a0d05cf8381bbeb69bc318d2ac4c744cc6060941ccfa1e102240ead5bbe2cc2271e67b7e8281f3251e339f398dfb89f2e8b2ab47b0a03bcbd36048fc9d09c4fa3022799b0f045e934dfe43aa3b70637d86f2a7990d4d44e5871ec53a96198f73969e0129c575872862729a51de532f32b99975abf2bb03cb406ea0e64ecb7cd65802417c2d937f5b1261035477b9a02ba54a24593ff79bf1a8cc59fb59fdf78e76b50f14794694b24b8da05e80c9d4f06ec4a31207e4f5d86842f35a3cd9cc184571f1fadc0e2a4b1ef296b2197a6d4feed0337b0fcf58d2abcdc8483e3dec3e75f
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: C=BE, O=GlobalSign nv,sa, CN=GlobalSign Extended Validation CodeSigning
        CA , SHA256 , G3
      TBS:
        MD5: fd8cfeea06be14fa89689909e1fc72dc
        SHA1: 8bc3cd2f70abe543e0dbe721065a4076c8521f36
        SHA256: 15e7050789df807f3e3174294a01b637a1239f603e42f4b5db9398efa9da9996
      ValidFrom: '2016-06-15 00:00:00'
      ValidTo: '2024-06-15 00:00:00'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 6129152700000000002a
      Signature: 5ff8d065746a81c6a6ca5b03b6914ae84bbdef2ba142f0efb4a5adcd3389ec0b9585ac62501108aa58d25aa08310e5a6337af25af2c5fe787cf09c83df190ad97396002dd62ccde914d41d9de83f3c1a76f7904efb01350a6c9313a0c356eb67a0e4d17a96dec267f190f80a7bf5321b94ec5f751f8d1b34da6c58a7cb2d279e2226b7c9aa30cc0777b836e38201b5393ccc8dd9a75f7f23b3877fdb5798918bd7ce2520e39d644fdd87f72b68490318e0a5df7c5f68644d36838d4781f2e9e0a869abfa7b163c05a449ea8830190a6c73055178dfd41ddd3ad47f2de44e54be83431e7a7433b4a4ebd77073bc2a02988966eef6bc8f749378e329025a5a43e258ce7ccf9acad236893be25fda26054ec8d4e72c910e1797c5beee8b13112323294ffa83d050f6bafad53db3173df4ff034aa325dce67561d1fa35086bd62744d068b78d45e0eb852cc8a15d614474160e5958aed2b5eea5bcd6d7076ab62978fd976767dd8d4f17944fd2ed0caf972437c3a29c81da6be143b6577b4cecbf791319e79fe844e94781b75e701e91f83dd17b27f50b7056434805dda92fab86101d0b12e31ad04c6e75ded645b30b748887935c564a41029af7aeb799d8b67f88fa11f2457cf4d71b91c01cf1a0fbd4080a411a142acef4eb34486e66879ed54b7a397fbb0e3d3861cf735706e412066bd96b5308cd7018c22d4f974691bca9f0
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=BE, O=GlobalSign nv,sa, OU=Root CA, CN=GlobalSign Root CA
      TBS:
        MD5: 0bb058d116f02817737920f112d9fd3b
        SHA1: fd116235171a4feafedee586b7a59185fb5fd7e6
        SHA256: f970426cc46d2ae0fc5f899fa19dbe76e05f07e525654c60c3c9399492c291f4
      ValidFrom: '2011-04-15 19:55:08'
      ValidTo: '2021-04-15 20:05:08'
      Version: 3
    - IsCertificateAuthority: false
      SerialNumber: 1ae9d4b848b34ca82bcf623a
      Signature: 00a4726dbfb611464678aaab7dfa3c9231d9c2c7690387c38601f064858035833f3b8473055e9d96d7dc6e35198c613bdb13ea5578842d80f194f21635d13ccf399f1996c929843783fd6d905506eba15f821bfcabf3a01ab67d25ab315c1eaae244d4fd779a45aaf0854ea46d0bcc3d97879314324c8176d283b83657f12ba7dc62209f9e365522f791f41ee263df2c978cac7676a04e2505a3d3fe698ec2e7287e0c479a9f43ca526cbea8050a859080e3198c47e958d3ea3f61a0901760263eaf8897c143167b2d973638eb4eb925b4de9452d83f850b683567c68979d40d339f200e20bfff8f852d6a716836af2f6cd18f861ad54667398ef197766db86c
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: ??=Private Organization, serialNumber=91420106MA4L0NHE9U, ??=CN, ??=HEBEI,
        ??=WUHAN, C=CN, ST=??????, L=??????, ??=???????????????????????????????????????????????????3???9???7???,
        O=??????????????????????????????, CN=??????????????????????????????
      TBS:
        MD5: dc1fd334ac7950329ff4fa45a3bde8da
        SHA1: f58e04e6dd1954a2fd06e5fedd1408a9c765dd18
        SHA256: 9ed1944c1abbe6ed081eb71a3da83e72f758c6dea4e009088a41cba22870bec3
      ValidFrom: '2018-11-15 10:01:02'
      ValidTo: '2021-11-15 10:01:02'
      Version: 3
    CertificatesInfo: ''
    Signer:
    - Issuer: C=BE, O=GlobalSign nv,sa, CN=GlobalSign Extended Validation CodeSigning
        CA , SHA256 , G3
      SerialNumber: 1ae9d4b848b34ca82bcf623a
      Version: 1
    SignerInfo: ''
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- LgDataCatcher.sys
Verified: 'TRUE'
