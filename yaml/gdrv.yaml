Acknowledgement:
  Handle: '@mattnotmax'
  Person: MattNotMax
Author: Michael Haag
Category: vulnerable driver
Commands:
  Command: 'sc.exe create gdrv.sys binPath=C:\windows\temp\gdrv.sys type=kernel

    sc.exe start gdrv.sys'
  Description: 'gdrv.sys is vulnerable to multiple CVEs: CVE-2018-19320, CVE-2018-19322,
    CVE-2018-19323, CVE-2018-19321. Read/Write Physical memory, read/write to/from
    IO ports, exposes ring0 memcpy-like functionality,  read and write Machine Specific
    Registers (MSRs).'
  OperatingSystem: Windows 10
  Privileges: kernel
  Usecase: Elevate privileges, tamper with PPL or system processes
Created: '2023-01-09'
Detection: []
KnownVulnerableSamples:
- Company: ''
  Date: 2013-07-03 17:32:00 UTC, 2017-11-30 18:40:00 UTC
  Description: GIGABYTE Tools, GIGA-BYTE NonPNP Driver
  FileVersion: '5.2.3790.1830 built by: WinDDK, 1.0.0.1'
  Filename: gdrv.sys
  MD5: ''
  MachineType: x64, x64
  OriginalFilename: gdrv.sys
  Product: Windows (R) Server 2003 DDK driver, gdrv64
  ProductVersion: ''
  Publisher: ''
  SHA1: ''
  SHA256: 31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427
  Signature: ''
- Company: ''
  Date: 2013-07-03 17:32:00 UTC, 2017-11-30 18:40:00 UTC
  Description: GIGABYTE Tools, GIGA-BYTE NonPNP Driver
  FileVersion: '5.2.3790.1830 built by: WinDDK, 1.0.0.1'
  Filename: gdrv.sys
  MD5: ''
  MachineType: x64, x64
  OriginalFilename: gdrv.sys
  Product: Windows (R) Server 2003 DDK driver, gdrv64
  ProductVersion: ''
  Publisher: ''
  SHA1: ''
  SHA256: ff6729518a380bf57f1bc6f1ec0aa7f3012e1618b8d9b0f31a61d299ee2b4339
  Signature: ''
MitreID: T1068
Name: gdrv.sys
Resources:
- ' https://github.com/hoangprod/DanSpecial'
- https://github.com/namazso/physmem_drivers
- https://www.secureauth.com/labs/advisories/gigabyte-drivers-elevation-privilege-vulnerabilities
- https://medium.com/@fsx30/weaponizing-vulnerable-driver-for-privilege-escalation-gigabyte-edition-e73ee523598b
Verified: 'TRUE'
driver_description: https://github.com/namazso/physmem_drivers
