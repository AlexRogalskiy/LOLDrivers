Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 6e1979ba-75ec-489e-b40b-7df730cd8b0b
KnownVulnerableSamples:
- Authentihash:
    MD5: 8c667904b9db9e69a637c55ae50decbd
    SHA1: bc2f3850c7b858340d7ed27b90e63b036881fd6c
    SHA256: f08ebddc11aefcb46082c239f8d97ceea247d846e22c4bcdd72af75c1cbc6b0b
  Company: ''
  Copyright: ''
  CreationTimestamp: '2021-05-15 06:46:21'
  Date: ''
  Description: ''
  ExportedFunctions: ''
  FileVersion: ''
  Filename: ''
  ImportedFunctions:
  - FwpsAcquireClassifyHandle0
  - FwpsReleaseClassifyHandle0
  - FwpmFilterDeleteById0
  - FwpsAcquireWritableLayerDataPointer0
  - FwpsApplyModifiedLayerData0
  - FwpmFilterAdd0
  - FwpmCalloutAdd0
  - FwpmSubLayerDeleteByKey0
  - FwpmSubLayerAdd0
  - FwpmTransactionAbort0
  - FwpmTransactionCommit0
  - FwpmTransactionBegin0
  - FwpmEngineClose0
  - FwpmEngineOpen0
  - FwpsCalloutUnregisterById0
  - FwpsCompleteClassify0
  - FwpsCalloutRegister1
  - IofCallDriver
  - IoCreateFile
  - IoFreeIrp
  - IoGetRelatedDeviceObject
  - ObReferenceObjectByHandle
  - ObfDereferenceObject
  - ZwQueryInformationFile
  - ZwSetInformationFile
  - ZwReadFile
  - ZwWriteFile
  - ZwClose
  - IoFileObjectType
  - KeEnterCriticalRegion
  - KeLeaveCriticalRegion
  - PsTerminateSystemThread
  - KeSetBasePriorityThread
  - sprintf
  - CmUnRegisterCallback
  - CmRegisterCallbackEx
  - CmCallbackGetKeyObjectID
  - MmIsAddressValid
  - strlen
  - strncmp
  - strncpy
  - wcscat
  - wcslen
  - wcsncmp
  - RtlInitAnsiString
  - strcat
  - strcmp
  - strncat
  - ExAllocatePoolWithTag
  - ExAcquireSpinLockExclusive
  - ExReleaseSpinLockExclusive
  - wcscpy
  - RtlAnsiStringToUnicodeString
  - RtlFreeUnicodeString
  - RtlCreateSecurityDescriptor
  - RtlSetDaclSecurityDescriptor
  - KeResetEvent
  - KeInitializeTimerEx
  - KeSetTimerEx
  - PsCreateSystemThread
  - ZwCreateKey
  - ZwOpenKey
  - ZwFlushKey
  - ZwQueryValueKey
  - ZwSetValueKey
  - NtQueryInformationToken
  - RtlLengthSid
  - RtlConvertSidToUnicodeString
  - RtlCreateAcl
  - RtlAddAccessAllowedAce
  - RtlSetOwnerSecurityDescriptor
  - PsLookupProcessByProcessId
  - ObOpenObjectByPointer
  - ZwOpenProcessTokenEx
  - ZwSetSecurityObject
  - PsGetProcessImageFileName
  - _allmul
  - PsProcessType
  - SeExports
  - strchr
  - strncpy_s
  - MmProbeAndLockPages
  - MmUnlockPages
  - IoAllocateMdl
  - IoFreeMdl
  - IoReuseIrp
  - IoAllocateIrp
  - RtlUnwind
  - KeWaitForSingleObject
  - KeSetEvent
  - KeInitializeEvent
  - KeGetCurrentThread
  - IoDeleteSymbolicLink
  - KeBugCheckEx
  - ExFreePoolWithTag
  - RtlInitUnicodeString
  - RtlCopyUnicodeString
  - strcpy
  - memset
  - memcpy
  - strstr
  - WskDeregister
  - WskReleaseProviderNPI
  - WskCaptureProviderNPI
  - WskRegister
  - KeGetCurrentIrql
  - WdfVersionBind
  - WdfVersionBindClass
  - WdfVersionUnbindClass
  - WdfVersionUnbind
  Imports:
  - fwpkclnt.sys
  - ntoskrnl.exe
  - NETIO.SYS
  - HAL.dll
  - WDFLDR.SYS
  InternalName: ''
  MD5: a01abca106a37eb4e7f96b1c4be38712
  MachineType: I386
  MagicHeader: 50 45 0 0
  OriginalFilename: ''
  PDBPath: ''
  Product: ''
  ProductVersion: ''
  Publisher: ''
  RichPEHeaderHash:
    MD5: f0b684c190bdbac4aa311a7355122963
    SHA1: b7866474ab0a322b84086fccf1948d5a8b7f03a0
    SHA256: 33c5dfb8ba99a1d23f6a99cb34c04977b2455fa6c59e79dbad4d910516357bae
  SHA1: 0f45c274b86bdcffba8d09a3cdfce974b10e3bfe
  SHA256: cfe2dd2cf1eb8b79d3b4ae980cda6fd933979d47c837fda77256a24a41316468
  Sections:
    .data:
      Entropy: 0.6890357570368669
      Virtual Size: '0x9428'
    .rdata:
      Entropy: 4.572425708982675
      Virtual Size: '0x5f4'
    .reloc:
      Entropy: 6.678416291453968
      Virtual Size: '0x694'
    .text:
      Entropy: 6.340579412340497
      Virtual Size: '0x5de8'
    INIT:
      Entropy: 5.674405086792681
      Virtual Size: '0xb48'
  Signature: ''
  Signatures: {}
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- ''
Verified: 'TRUE'
