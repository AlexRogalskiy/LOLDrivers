Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: fe0a64a7-1407-4a9f-8b45-9ff616403dac
KnownVulnerableSamples:
- Authentihash:
    MD5: 3361957860d2b65c0368778ca088946f
    SHA1: 6a784d45517142c11d5cca3ff9956b2ed6eaf4c9
    SHA256: e94e8a87459db56837d1c58f9854794aa99f36566a9ded9b398be9d4d3a2c2af
  Company: Windows (R) Win 7 DDK provider
  Copyright: "Copyright \xA9 NetFilterSDK.com"
  CreationTimestamp: '2020-09-15 00:54:41'
  Date: ''
  Description: NetFilter SDK WFP Driver (WPP)
  ExportedFunctions: ''
  FileVersion: 1.5.9.7
  Filename: ''
  ImportedFunctions:
  - FwpmFreeMemory0
  - FwpmEngineOpen0
  - FwpmEngineClose0
  - FwpmTransactionBegin0
  - FwpmTransactionCommit0
  - FwpmTransactionAbort0
  - FwpmProviderAdd0
  - FwpmProviderContextDeleteByKey0
  - FwpmSubLayerAdd0
  - FwpmSubLayerDeleteByKey0
  - FwpmSubLayerCreateEnumHandle0
  - FwpmSubLayerEnum0
  - FwpmSubLayerDestroyEnumHandle0
  - FwpmCalloutAdd0
  - FwpmFilterAdd0
  - FwpsFlowAbort0
  - FwpsInjectionHandleCreate0
  - FwpsInjectionHandleDestroy0
  - FwpsRedirectHandleCreate0
  - FwpsFreeNetBufferList0
  - FwpsFreeCloneNetBufferList0
  - FwpsInjectNetworkSendAsync0
  - FwpsConstructIpHeaderForTransportPacket0
  - FwpsInjectTransportSendAsync0
  - FwpsInjectTransportReceiveAsync0
  - FwpsInjectNetworkReceiveAsync0
  - FwpsStreamInjectAsync0
  - FwpsCopyStreamDataToBuffer0
  - FwpmBfeStateGet0
  - FwpmBfeStateSubscribeChanges0
  - FwpmBfeStateUnsubscribeChanges0
  - FwpsFlowRemoveContext0
  - FwpsCompleteClassify0
  - FwpsRedirectHandleDestroy0
  - FwpsCloneStreamData0
  - FwpsDiscardClonedStreamData0
  - FwpsQueryPacketInjectionState0
  - FwpsApplyModifiedLayerData0
  - FwpsAcquireWritableLayerDataPointer0
  - FwpsReleaseClassifyHandle0
  - FwpsAcquireClassifyHandle0
  - FwpsFlowAssociateContext0
  - FwpsCalloutUnregisterByKey0
  - FwpsCalloutRegister1
  - FwpsPendClassify0
  - FwpsAllocateNetBufferAndNetBufferList0
  - NdisFreeNetBufferListPool
  - NdisAllocateNetBufferListPool
  - NdisWaitEvent
  - NdisInitializeEvent
  - NdisFreeGenericObject
  - NdisAllocateGenericObject
  - NdisGetDataBuffer
  - NdisAdvanceNetBufferDataStart
  - NdisRetreatNetBufferDataStart
  - KeAcquireInStackQueuedSpinLock
  - KeReleaseInStackQueuedSpinLock
  - ExAllocatePoolWithTag
  - ExUuidCreate
  - swprintf_s
  - RtlInitUnicodeString
  - MmGetSystemRoutineAddress
  - RtlAppendUnicodeToString
  - RtlCreateSecurityDescriptor
  - RtlSetDaclSecurityDescriptor
  - KeInitializeEvent
  - KeSetEvent
  - KeWaitForSingleObject
  - KeInitializeSpinLock
  - ExFreePoolWithTag
  - ExQueryDepthSList
  - ExpInterlockedPopEntrySList
  - ExpInterlockedPushEntrySList
  - ExInitializeNPagedLookasideList
  - ExDeleteNPagedLookasideList
  - MmBuildMdlForNonPagedPool
  - MmMapLockedPagesSpecifyCache
  - MmUnmapLockedPages
  - MmAllocatePagesForMdl
  - MmFreePagesFromMdl
  - PsCreateSystemThread
  - PsTerminateSystemThread
  - IoAllocateMdl
  - IofCompleteRequest
  - IoCreateDevice
  - IoCreateSymbolicLink
  - IoDeleteDevice
  - IoDeleteSymbolicLink
  - IoFreeMdl
  - IoReleaseCancelSpinLock
  - ObReferenceObjectByHandle
  - ObfDereferenceObject
  - ZwClose
  - ZwOpenKey
  - ZwQueryValueKey
  - PsGetCurrentProcessId
  - ZwSetInformationThread
  - RtlLengthSid
  - RtlCreateAcl
  - RtlAddAccessAllowedAce
  - PsLookupProcessByProcessId
  - ObOpenObjectByPointer
  - ZwSetSecurityObject
  - __C_specific_handler
  - SeExports
  - RtlGetVersion
  - RtlCompareMemory
  - RtlValidSid
  Imports:
  - fwpkclnt.sys
  - NDIS.SYS
  - ntoskrnl.exe
  InternalName: netfilter2.sys
  MD5: 724c7d404a7c182084c6f6c2d20e9e05
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: netfilter2.sys
  PDBPath: ''
  Product: Windows (R) Win 7 DDK driver
  ProductVersion: 6.2.9200.20557
  Publisher: ''
  RichPEHeaderHash:
    MD5: c646eed94ec9e75c1a5498d3642cdab3
    SHA1: 0d0761641e424cc895ba76723784427fcf297f4a
    SHA256: 7cecb42d3d4ae8649f3b4714fbab29c4cef8e24a48b0eea2537824fc40f4ea7f
  SHA1: ac056610db0b5f616aafacdc565d9b9f95870e60
  SHA256: 71701c5c569ef67391c995a12b21ca06935b7799ed211d978f7877115c58dce0
  Sections:
    .data:
      Entropy: 2.2005364202433433
      Virtual Size: '0x18c0'
    .pdata:
      Entropy: 5.031237899973202
      Virtual Size: '0xe40'
    .rdata:
      Entropy: 4.871173021345663
      Virtual Size: '0x1ddc'
    .reloc:
      Entropy: 3.7790472033993128
      Virtual Size: '0x228'
    .rsrc:
      Entropy: 3.5922103150308553
      Virtual Size: '0x448'
    .text:
      Entropy: 6.150053710509848
      Virtual Size: '0x1019a'
    INIT:
      Entropy: 5.179921200293236
      Virtual Size: '0xeca'
  Signature: ''
  Signatures:
  - Certificates:
    - IsCertificateAuthority: false
      SerialNumber: 330000003a6ae333708fda7a7b00000000003a
      Signature: 7dfc7c353c4c04d9d06066e1ca8584637192eb15d1d6e7c5521b0d819d615fb56524985d30535b0573fb8e0d13173d51b27bd23b9a2052738891d67ed360766452b62c4566eb20c90f018229a8e951bf58df5a7d731c1e51217f471d470979f04e900920bfc8715122b331d82f68f73ebf3de36e09d18fbfed2f3c29190a41baafbca0025bf4e36310a04cb8e61c32fda677820aa693a7f5e69d3c3abdb495b12bb8b6d10f65d44fae945d9b0fcf695d4711fc9e1c0ddb1f569c13093e16c389f748d8fe60e8685f02357464564761db4cece391baa742f3ad3bcfa26e01975966ca41939c832bf1147bec870162ce042fd0cf10d048181ec573d317f2c5de21512f13b24de9bac9bb83fc2ceb4f6f766536fe38c03ede1f8b0a3b8828e8d914d73d0a17699ab20264a27a36e0f77c5144cf470bf44d2296290e345bd25c0bc6a08dd963ec39ce0e500599751c652dc20e9906c1ce76c1d86c09058ae8defb3d7b93b68a34ca83a981a30c2403723f7e5c664b1e951050002ad32e976db221c2d8c660047dc6acfe0da16d44c6372a5cd04b016a35193f841b903ba87e2d6e416a2c59469af9f16e249bb891f21ec22f2db0a84a48d7a9e43d2f7e3bdd016d600f57daf21829885ec035287ab332c32738f5e26c6d2502b2f044afb1e048c85c7c9baf76747de14ecdeca3c7481796a741672a047f89dafe2c12c01982a026c4
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Hardware Compatibility Publisher
      TBS:
        MD5: 6f5d716e7151f1c173396adb7213359e
        SHA1: 100610baae90027e9844a8e9c4d489fe122ecd9c
        SHA256: 677d532777cee24be88442efec75e9640e80ef57d8e1246396459a1a04be733f
      ValidFrom: '2020-03-11 17:31:14'
      ValidTo: '2021-03-05 17:31:14'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 330000000d690d5d7893d076df00000000000d
      Signature: 96b5c33b31f27b6ba11f59dd742c3764b1bca093f9f33347e9f95df21d89f4579ee33f10a3595018053b142941b6a70e5b81a2ccbd8442c1c4bed184c2c4bd0c8c47bcbd8886fb5a0896ae2c2fdfbf9366a32b20ca848a6945273f732332936a23e9fffdd918edceffbd6b41738d579cf8b46d499805e6a335a9f07e6e86c06ba8086725afc0998cdba7064d4093188ba959e69914b912178144ac57c3ae8eae947bcb3b8edd7ab4715bba2bc3c7d085234b371277a54a2f7f1ab763b94459ed9230cce47c099212111f52f51e0291a4d7d7e58f8047ff189b7fd19c0671dcf376197790d52a0fbc6c12c4c50c2066f50e2f5093d8cafb7fe556ed09d8a753b1c72a6978dcf05fe74b20b6af63b5e1b15c804e9c7aa91d4df72846782106954d32dd6042e4b61ac4f24636de357302c1b5e55fb92b59457a9243d7c4e963dd368f76c728caa8441be8321a66cde5485c4a0a602b469206609698dcd933d721777f886dac4772daa2466eab64682bd24e98fb35cc7fec3f136d11e5db77edc1c37e1f6a4a14f8b4a721c671866770cdd819a35d1fa09b9a7cc55d4d728e74077fa74d00fcdd682412772a557527cda92c1d8e7c19ee692c9f7425338208db38cc7cc74f6c3a6bc237117872fe55596460333e2edfc42de72cd7fb0a82256fb8d70c84a5e1c4746e2a95329ea0fecdb4188fd33bad32b2b19ab86d0543fbff0d0f
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Third Party Component CA 2014
      TBS:
        MD5: 83f69422963f11c3c340b81712eef319
        SHA1: 0c5e5f24590b53bc291e28583acb78e5adc95601
        SHA256: d8be9e4d9074088ef818bc6f6fb64955e90378b2754155126feebbbd969cf0ae
      ValidFrom: '2014-10-15 20:31:27'
      ValidTo: '2029-10-15 20:41:27'
      Version: 3
    CertificatesInfo: ''
    Signer:
    - Issuer: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Third Party Component CA 2014
      SerialNumber: 330000003a6ae333708fda7a7b00000000003a
      Version: 1
    SignerInfo: ''
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- netfilter2.sys
Verified: 'TRUE'
