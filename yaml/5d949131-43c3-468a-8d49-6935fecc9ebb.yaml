Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 5d949131-43c3-468a-8d49-6935fecc9ebb
KnownVulnerableSamples:
- Authentihash:
    MD5: a25749ae40ff475524e5df6431998825
    SHA1: 59c8f056dea50a4b6f6f63e50037089965568910
    SHA256: 2fb5d7e6db01c9090bba92abf580d38993e02ce9357e08fe1f224a9b18056e5a
  Company: ''
  Copyright: ''
  CreationTimestamp: '2020-08-11 23:45:00'
  Date: ''
  Description: ''
  ExportedFunctions: ''
  FileVersion: ''
  Filename: ''
  ImportedFunctions:
  - DbgPrintEx
  - RtlGetVersion
  - KeInitializeEvent
  - KeWaitForSingleObject
  - ExAllocatePoolWithTag
  - ExAllocatePoolWithQuotaTag
  - ExFreePoolWithTag
  - MmBuildMdlForNonPagedPool
  - MmMapLockedPagesSpecifyCache
  - MmUnmapLockedPages
  - MmMapIoSpace
  - MmUnmapIoSpace
  - IoAllocateErrorLogEntry
  - IoAllocateMdl
  - IoBuildDeviceIoControlRequest
  - IoBuildSynchronousFsdRequest
  - IofCallDriver
  - IofCompleteRequest
  - IoCreateDevice
  - IoCreateSymbolicLink
  - IoDeleteDevice
  - IoDeleteSymbolicLink
  - IoFreeMdl
  - IoGetAttachedDeviceReference
  - IoGetDeviceObjectPointer
  - IoWriteErrorLogEntry
  - IoGetDeviceProperty
  - ObReferenceObjectByHandle
  - ObReferenceObjectByPointer
  - RtlAppendUnicodeToString
  - ZwCreateFile
  - ZwWriteFile
  - ZwClose
  - ZwOpenSection
  - ZwMapViewOfSection
  - ZwUnmapViewOfSection
  - ZwOpenKey
  - ZwQueryValueKey
  - MmGetPhysicalMemoryRanges
  - PsGetProcessId
  - RtlFillMemoryUlong
  - KeStackAttachProcess
  - KeUnstackDetachProcess
  - IoEnumerateDeviceObjectList
  - ObQueryNameString
  - _vsnwprintf
  - ObReferenceObjectByName
  - memcpy
  - memmove
  - memset
  - IoFileObjectType
  - PsProcessType
  - PsInitialSystemProcess
  - NtBuildNumber
  - IoDriverObjectType
  - KeRevertToUserAffinityThread
  - KeSetSystemAffinityThread
  - KeQueryActiveProcessors
  - KeBugCheckEx
  - RtlAppendUnicodeStringToString
  - RtlUnwind
  - RtlWriteRegistryValue
  - MmGetSystemRoutineAddress
  - RtlQueryRegistryValues
  - RtlInitUnicodeString
  - RtlIntegerToUnicodeString
  - ObfDereferenceObject
  - wcsrchr
  - WRITE_PORT_USHORT
  - WRITE_PORT_UCHAR
  - READ_PORT_ULONG
  - READ_PORT_USHORT
  - READ_PORT_UCHAR
  - KeStallExecutionProcessor
  - WRITE_PORT_ULONG
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  InternalName: ''
  MD5: ddcfe3f11e3890ebc986bdb073b3b280
  MachineType: I386
  MagicHeader: 50 45 0 0
  OriginalFilename: ''
  PDBPath: ''
  Product: ''
  ProductVersion: ''
  Publisher: ''
  RichPEHeaderHash:
    MD5: 78c0e4d4898d4d4cc2c6df5285c1e11b
    SHA1: 0c932c2f26d8d024936f27bc6ff33dc736587a6e
    SHA256: cae87d0bcaa037bfb6c422692648e50bb26aad2909044f1cdb1d6cb706dd94d1
  SHA1: 4e24f6a3d97c7bd8a9d3ccd405e6ce15568e8462
  SHA256: 96597bc54e6ec98a0f00d2fe448043def67c977b464984c870066693dc37fbc0
  Sections:
    .data:
      Entropy: 2.450212064914747
      Virtual Size: '0x1c'
    .rdata:
      Entropy: 4.091327919587039
      Virtual Size: '0x454'
    .reloc:
      Entropy: 6.43814817478269
      Virtual Size: '0x28c'
    .text:
      Entropy: 6.122291821648682
      Virtual Size: '0x3162'
    INIT:
      Entropy: 5.60467066998622
      Virtual Size: '0x824'
    PAGE:
      Entropy: 5.1712774885026676
      Virtual Size: '0x82'
  Signature: ''
  Signatures: {}
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- ''
Verified: 'TRUE'
