Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 00d283a8-adc0-4a52-a2c8-f18a00a5e8cf
KnownVulnerableSamples:
- Authentihash:
    MD5: 844d7fd5ec208cdb66f3cc238b32139f
    SHA1: 0e7956ca48ab640cf72c4030f77c6e62bdf6eab4
    SHA256: 3327d9e938d4ae29de110e219662ce04932935a7886e99feb508ffe77c9e00c2
  Company: gentilkiwi (Benjamin DELPY)
  Copyright: Copyright (c) 2007 - 2020 gentilkiwi (Benjamin DELPY)
  CreationTimestamp: '2020-08-04 17:23:09'
  Date: ''
  Description: mimidrv for Windows (mimikatz)
  ExportedFunctions: ''
  FileVersion: 2.2.0.0
  Filename: ''
  ImportedFunctions:
  - NtBuildNumber
  - IofCompleteRequest
  - KeBugCheck
  - IoCreateSymbolicLink
  - IoCreateDevice
  - PsInitialSystemProcess
  - ObfDereferenceObject
  - PsLookupProcessByProcessId
  - PsGetProcessImageFileName
  - PsGetProcessId
  - ZwClose
  - ZwSetInformationProcess
  - ZwDuplicateToken
  - ObOpenObjectByPointer
  - PsProcessType
  - RtlInitUnicodeString
  - PsReferencePrimaryToken
  - IoGetCurrentProcess
  - RtlCompareMemory
  - ZwOpenProcessTokenEx
  - ExFreePoolWithTag
  - ExAllocatePoolWithTag
  - IoFreeMdl
  - MmUnlockPages
  - MmProbeAndLockPages
  - IoAllocateMdl
  - memcpy
  - KeServiceDescriptorTable
  - IoEnumerateRegisteredFiltersList
  - KeTickCount
  - MmGetSystemRoutineAddress
  - IoDeleteSymbolicLink
  - IoDeleteDevice
  - memset
  - PsDereferencePrimaryToken
  - _vsnwprintf
  - PsGetVersion
  - ExAllocatePoolWithQuotaTag
  - ZwQuerySystemInformation
  - RtlUnwind
  - KeBugCheckEx
  - FltGetFilterInformation
  - FltEnumerateInstances
  - FltGetVolumeFromInstance
  - FltObjectDereference
  - FltEnumerateFilters
  Imports:
  - ntoskrnl.exe
  - FLTMGR.SYS
  InternalName: mimidrv
  MD5: 1e0eb80347e723fa31fce2abb0301d44
  MachineType: I386
  MagicHeader: 50 45 0 0
  OriginalFilename: mimidrv.sys
  PDBPath: ''
  Product: mimidrv (mimikatz)
  ProductVersion: 2.2.0.0
  Publisher: ''
  RichPEHeaderHash:
    MD5: c4873a245675b1071413f34af4d80050
    SHA1: dd32c95fe9c3a8bcfa7623a732f2492214ff5881
    SHA256: 2673ca796c70fa90f1374f5b3699e6a168ef6168dbe7a95b9d9179fe8067d7af
  SHA1: 01cf1fe3937fb6585ffb468b116a3af8ddf9ef16
  SHA256: 1a5c08d40a5e73b9fe63ea5761eaec8f41d916ca3da2acbc4e6e799b06af5524
  Sections:
    .data:
      Entropy: 2.813191841547333
      Virtual Size: '0x14dc'
    .rdata:
      Entropy: 3.545537533502987
      Virtual Size: '0xff4'
    .reloc:
      Entropy: 6.0011548156682
      Virtual Size: '0x4a0'
    .rsrc:
      Entropy: 3.3459452702797696
      Virtual Size: '0x430'
    .text:
      Entropy: 6.2064317372812985
      Virtual Size: '0x2404'
    INIT:
      Entropy: 5.4281677070245955
      Virtual Size: '0x538'
    PAGE:
      Entropy: 5.804360087879422
      Virtual Size: '0x266'
  Signature: ''
  Signatures:
  - Certificates:
    - IsCertificateAuthority: false
      SerialNumber: 112169417a1c3ef46a301f99385f50680fa0
      Signature: 7fb3e0f79a942f494fd6e5cd42f04eea33420dc8c6285b79807d4e8cd45ec65fa9a5abcf516482827302f51cc924e484461c67d6b3338ebbaf39129dda0b6d617a25bad53f7ed4af3c934bed8d683091e72b93668d6623670d9cc6d8f4999e896ec6c707d5acaddcae899be3ae42945efbd9e60a36bfb49e6fef09179f02c5c49059c159c2ccaf2e9e171dcd0476dfbffbb7f3a4d59a36ef9e7931aaab9c9821527e6081c2a57ce78863caaf81cb50537956191320b48053552b3ee2bc64878ae903105a8a4d4a85bf235040d02215601143aa9a304eeb5058354f9195069ceb08cdf1f07ec0575b64b0d1840947df070c3c65571226da895da14ac6ae5bd3b8
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=FR, CN=Benjamin Delpy
      TBS:
        MD5: ee0a53dda8301d1e78bd5487f1d49bf4
        SHA1: 5538f8cd492c2ec8d581f3665d2b4217c86fa19a
        SHA256: a39725e610e1a556e7bdfad56f59d24a5278073378a5d9880e14395bbd808deb
      ValidFrom: '2011-06-28 09:46:16'
      ValidTo: '2014-06-28 09:46:16'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 751e3ee9c5dc2f3e8f04e59dee5ed409
      Signature: 1e2e9fd69b54b405cefee51b1f7fc5a8888b88efb71586907960c6a85cf47ace95c3e2200f4dc558fc968afa3bdf3ba001dec95c5c3c549db3ce3495207db396241856f30229b5bcc8e6c038a68a23fcd652c212b75740c4bcab36642e5f234f34a5232bc55bfe980d43b751af7d7e6d175b31f638253562be56b3b4399c1a89538b45999ceb9f8aeac33d6346e4e8dbf71f5070a4a5eebc27050857ae7e05355a134aa2ddaa0259cca96f4dc6824016adc0a15d37478885bb53a3203911b4c8c44ff6b5a2a3100162418286e2906edbfd09628ac353d9054aa42483e83ba6b1129464a09a350e4cf59e18caaeccbfb56d2f29bb956a0364eeb6a80da5c53429
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      Subject: C=BE, O=GlobalSign nv,sa, CN=GlobalSign CodeSigning CA , G2
      TBS:
        MD5: a637f8f3c278575f41cda67c2063c050
        SHA1: debd0fdaef0c60f58c4b60d3b58ace611c9a5c43
        SHA256: f6cae0b028995eb13b1c2cce5b5107384ab7c77279ae5560933e345061d99cc0
      ValidFrom: '2011-04-13 10:00:00'
      ValidTo: '2026-04-13 10:00:00'
      Version: 3
    - IsCertificateAuthority: true
      SerialNumber: 610b7f6b000000000019
      Signature: 13c56c5e077f3c57ff9b315f3fbd955425c679f92c31034d64694b56d95b976f7cf3f0d024657538639813701613f7a701f1c623e085866c0bf080945a75e87ce41e92b473bfc1b3a7b00bd31884cbcc09a35c9c4f3eb03a9c2d1bc404ef9737966fe5ecbaac6ab3d4e23cdf8b25e7acbc624531dda40a72e41bf8784301ccba3914de5d90aed85acf5eca46815133d5a60e5867d3d8665888169beeb11acaad91138421da9a6e20efda007428bac95ff34d5dc3da25692554ea44bcc39b29331cd63c961f8781c553d72a2733d42e197c08586ddb4e1999a9ea5ff39a9d8c513a5a5cbd2fa908359b54a7db351a521633343aa380046afdb4838cad90cf0c3a6596ec334e1826b849bbeb8192ff134d324b23c733e7b6716b15f69c80e6bcb76cbe41d5033a7133150050743b0e5df996aaed903eab134c809926bc38a5eb0236891db620be83ab10f8199ed76379d4aeb12f6136f94a4ba833c70e7241f9f1b1907eae46efde397b75a0411459041d42bc4788b8130e05fa1df0808dff70c677d84bdc460e231a72d5bfdefeaaae69583cfc5c46e4d5819a8b6e6559771a32a590a6b6649364fd0753c9a0de28ad2a6cc638d181ce98f54019e92c1743a4265fd3443053e41d02baa40a2f16dd7a60275242bbad98372897e4b8d27911e3108c48d5305d0a0c52def588ea8d1a2d67c9f4801484b7850cd16628a5c66f2461
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      Subject: C=BE, O=GlobalSign nv,sa, OU=Root CA, CN=GlobalSign Root CA
      TBS:
        MD5: 4798d55be7663a75649cda4dedc686ef
        SHA1: 0f1ab2937b245d9466ea6f9bf056a5942e3989cf
        SHA256: ef14ea05bb066ee9f4188196dd69cd769b283ac4d7555db52f5e76922d3456e1
      ValidFrom: '2006-05-23 17:00:51'
      ValidTo: '2016-05-23 17:10:51'
      Version: 3
    CertificatesInfo: ''
    Signer:
    - Issuer: C=BE, O=GlobalSign nv,sa, CN=GlobalSign CodeSigning CA , G2
      SerialNumber: 112169417a1c3ef46a301f99385f50680fa0
      Version: 1
    SignerInfo: ''
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- mimidrv.sys
Verified: 'TRUE'
