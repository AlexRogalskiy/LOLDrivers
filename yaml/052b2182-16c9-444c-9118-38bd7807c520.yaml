Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 052b2182-16c9-444c-9118-38bd7807c520
KnownVulnerableSamples:
- Authentihash:
    MD5: bb59340eceecb279389290775536523a
    SHA1: b3410021ea5a46818d9ff05a96c2809a9abe8e4a
    SHA256: b6bf2460e023b1005cc60e107b14a3cfdf9284cc378a086d92e5dcdf6e432e2c
  Company: ASRock Incorporation
  Copyright: Copyright (C) 2012 ASRock Incorporation
  CreationTimestamp: '2016-04-08 21:22:23'
  Date: ''
  Description: ASRock IO Driver
  ExportedFunctions: ''
  FileVersion: '1.00.00.0000 built by: WinDDK'
  Filename: ''
  ImportedFunctions:
  - RtlQueryRegistryValues
  - MmUnmapIoSpace
  - IoFreeMdl
  - MmGetPhysicalAddress
  - IoBuildAsynchronousFsdRequest
  - MmMapIoSpace
  - IofCompleteRequest
  - IoFreeIrp
  - RtlCompareMemory
  - MmUnlockPages
  - IoCreateSymbolicLink
  - MmAllocateContiguousMemorySpecifyCache
  - IofCallDriver
  - KeBugCheckEx
  - IoDeleteDevice
  - MmGetSystemRoutineAddress
  - IoCreateDevice
  - ZwClose
  - ObOpenObjectByPointer
  - ZwSetSecurityObject
  - IoDeviceObjectType
  - _snwprintf
  - RtlLengthSecurityDescriptor
  - SeCaptureSecurityDescriptor
  - RtlCreateSecurityDescriptor
  - RtlSetDaclSecurityDescriptor
  - RtlAbsoluteToSelfRelativeSD
  - IoIsWdmVersionAvailable
  - SeExports
  - wcschr
  - _wcsnicmp
  - RtlLengthSid
  - RtlAddAccessAllowedAce
  - RtlGetSaclSecurityDescriptor
  - RtlGetDaclSecurityDescriptor
  - RtlGetGroupSecurityDescriptor
  - RtlGetOwnerSecurityDescriptor
  - ZwOpenKey
  - ZwCreateKey
  - ZwQueryValueKey
  - ZwSetValueKey
  - RtlFreeUnicodeString
  - RtlInitUnicodeString
  - MmFreeContiguousMemorySpecifyCache
  - ExFreePoolWithTag
  - IoDeleteSymbolicLink
  - ExAllocatePoolWithTag
  - KeStallExecutionProcessor
  - BCryptCloseAlgorithmProvider
  - BCryptGenerateSymmetricKey
  - BCryptOpenAlgorithmProvider
  - BCryptDecrypt
  - BCryptDestroyKey
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  - cng.sys
  InternalName: AsrDrv.sys
  MD5: 9c56e390589ceb75d773229567924dcd
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: AsrDrv.sys
  PDBPath: ''
  Product: ASRock IO Driver
  ProductVersion: 1.00.00.0000
  Publisher: ''
  RichPEHeaderHash:
    MD5: 6540c04d181ea1395978a08c3d816451
    SHA1: b3b7c684121b40f53751e0b7757ec248ef0670b4
    SHA256: c68faaf4251928872474abfd81ef5ce8a2b5e5bd48c2edb586a4d2e518baa09d
  SHA1: b41fe1d44e2b3d562166e698d732a1ef1b2372df
  SHA256: 4d03a01257e156a3a018230059052791c3cde556e5cec7a4dd2f55f65c06e146
  Sections:
    .data:
      Entropy: 1.3791658791138062
      Virtual Size: '0x31c'
    .pdata:
      Entropy: 4.2004883967539595
      Virtual Size: '0x2b8'
    .rdata:
      Entropy: 4.489737477422066
      Virtual Size: '0x7c4'
    .reloc:
      Entropy: 1.2280731978955797
      Virtual Size: '0x60'
    .rsrc:
      Entropy: 3.2917593657396744
      Virtual Size: '0x3a0'
    .text:
      Entropy: 6.3051619106052055
      Virtual Size: '0x2238'
    INIT:
      Entropy: 5.432528075542002
      Virtual Size: '0x93a'
    PAGE:
      Entropy: 6.220333128676603
      Virtual Size: '0x1a47'
  Signature: ''
  Signatures: {}
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- AsrDrv.sys
Verified: 'TRUE'
