Acknowledgement:
  Handle: ''
  Person: ''
Author: Michael Haag
CVE:
- ''
Category: vulnerable drivers
Commands:
  Command: ''
  Description: Confirmed vulnerable driver from Microsoft Block List
  OperatingSystem: Windows
  Privileges: kernel
  Usecase: Elevate privileges
Created: '2023-07-22'
Detection:
- type: ''
  value: ''
Id: 62dc9e6c-8741-4d38-a26d-58d90c031c03
KnownVulnerableSamples:
- Authentihash:
    MD5: d86884546c97e614b73d16c600cfb2df
    SHA1: 94f7575a6bb378d0cf85b3dc65941c95415e7a80
    SHA256: 3bc0cec99dce687304dad8f7a6daf772e695cbd0169d346d03ae12500361a1e8
  Company: Phoenix Technologies
  Copyright: EnTech Taiwan, 1997-2009
  CreationTimestamp: '2009-12-14 03:23:26'
  Date: ''
  Description: DriverAgent Direct I/O for 64-bit Windows
  ExportedFunctions: ''
  FileVersion: '6.0'
  Filename: ''
  ImportedFunctions:
  - KeInitializeDpc
  - IofCompleteRequest
  - IoCreateSymbolicLink
  - IoCreateDevice
  - IofCallDriver
  - ExFreePoolWithTag
  - ExAllocatePool
  - ZwClose
  - MmUnmapLockedPages
  - IoDeleteDevice
  - KeSetEvent
  - MmFreeContiguousMemory
  - MmUnmapIoSpace
  - IoFreeMdl
  - ZwUnmapViewOfSection
  - IoConnectInterrupt
  - IoDisconnectInterrupt
  - IoStartNextPacket
  - KeInsertQueueDpc
  - MmMapLockedPages
  - ZwMapViewOfSection
  - MmBuildMdlForNonPagedPool
  - MmGetPhysicalAddress
  - MmMapLockedPagesSpecifyCache
  - ObReferenceObjectByHandle
  - ZwOpenSection
  - IoAllocateMdl
  - MmAllocateContiguousMemory
  - KeBugCheckEx
  - RtlInitUnicodeString
  - _snwprintf
  - IoCreateNotificationEvent
  - IoDeleteSymbolicLink
  - HalTranslateBusAddress
  - HalGetInterruptVector
  - KeStallExecutionProcessor
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  InternalName: Agent64.sys
  MD5: fe71c99a5830f94d77a8792741d6e6c7
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: Agent64.sys
  PDBPath: ''
  Product: DriverAgent
  ProductVersion: '6.0'
  Publisher: ''
  RichPEHeaderHash:
    MD5: dd9ea0c6c3773a8caf1a86726551af41
    SHA1: 45509ef0d417fb2a30496adc9511d048e4730f98
    SHA256: 5b467c45ee29fdaba31eff00eacc8db61940f94a9bf6a357c0663c58b2cd752b
  SHA1: acb5d7e182a108ee02c5cb879fc94e0d6db7dd68
  SHA256: 4db1e0fdc9e6cefeb1d588668ea6161a977c372d841e7b87098cf90aa679abfb
  Sections:
    .data:
      Entropy: 0.36599028709984766
      Virtual Size: '0x198'
    .pdata:
      Entropy: 3.801830276557545
      Virtual Size: '0xf0'
    .rdata:
      Entropy: 4.254011605715145
      Virtual Size: '0x2c8'
    .rsrc:
      Entropy: 3.2916671010793452
      Virtual Size: '0x3f8'
    .text:
      Entropy: 6.202530356985499
      Virtual Size: '0x1e7e'
    INIT:
      Entropy: 4.959426922678397
      Virtual Size: '0x4e4'
  Signature: ''
  Signatures: {}
MitreID: T1068
Resources:
- https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
Tags:
- Agent64.sys
Verified: 'TRUE'
